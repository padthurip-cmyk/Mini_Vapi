<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vapi AI Assistant - System Ready</title>
    
    <script src="https://cdn.jsdelivr.net/gh/VapiAI/html-sdk@latest/dist/vapi.js"></script>

    <style>
        :root { --primary: #6366f1; --danger: #ef4444; --success: #22c55e; }
        body { font-family: 'Inter', system-ui, sans-serif; background: #0f172a; color: white; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .container { background: #1e293b; padding: 2rem; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); width: 100%; max-width: 400px; text-align: center; border: 1px solid #334155; }
        .status-badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; margin-bottom: 1rem; background: #334155; }
        .logs { background: #000; color: #00ff00; font-family: monospace; font-size: 0.75rem; padding: 10px; border-radius: 8px; text-align: left; height: 100px; overflow-y: auto; margin-top: 1rem; border: 1px solid #334155; }
        button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; transition: 0.2s; }
        #start-btn { background: var(--primary); color: white; }
        #stop-btn { background: var(--danger); color: white; display: none; }
        #mic-btn { background: transparent; border: 1px solid #475569; color: #94a3b8; font-size: 0.8rem; }
        .active { color: var(--success); }
    </style>
</head>
<body>

<div class="container">
    <div id="connection-status" class="status-badge">SDK Connection: Checking...</div>
    <h2>üéôÔ∏è Vapi Assistant</h2>
    
    <button id="mic-btn">üé§ Force Mic Access</button>
    <button id="start-btn">Start Listening</button>
    <button id="stop-btn">Stop Assistant</button>

    <div class="logs" id="console-logs">
        12:39:09 PM - System Loaded...
    </div>
</div>



<script>
    // --- CONFIGURATION ---
    const VAPI_PUBLIC_KEY = 'your-public-key-here'; // Replace with pk_...
    const ASSISTANT_ID = 'your-assistant-id-here';   // Replace with UUID
    
    let vapi = null;
    const logEl = document.getElementById('console-logs');
    const statusEl = document.getElementById('connection-status');
    const startBtn = document.getElementById('start-btn');
    const stopBtn = document.getElementById('stop-btn');

    function addLog(msg) {
        const time = new Date().toLocaleTimeString();
        logEl.innerHTML += `<div>${time} - ${msg}</div>`;
        logEl.scrollTop = logEl.scrollHeight;
    }

    // Initialize Function
    function initVapi() {
        try {
            if (typeof Vapi === 'undefined') {
                throw new Error("Vapi SDK not loaded yet.");
            }
            vapi = new Vapi(VAPI_PUBLIC_KEY);
            statusEl.innerText = "SDK Connection: Ready";
            statusEl.classList.add('active');
            addLog("SDK Initialized successfully.");
            
            // Event Listeners
            vapi.on('call-start', () => {
                addLog("Call started successfully.");
                startBtn.style.display = 'none';
                stopBtn.style.display = 'block';
            });

            vapi.on('call-end', () => {
                addLog("Call ended.");
                startBtn.style.display = 'block';
                stopBtn.style.display = 'none';
            });

            vapi.on('error', (e) => {
                addLog(`Error: ${e.message || 'Unknown error'}`);
                console.error(e);
            });

        } catch (err) {
            addLog(`SDK Init Failed: ${err.message}`);
        }
    }

    // Force Microphone Access
    document.getElementById('mic-btn').addEventListener('click', async () => {
        try {
            await navigator.mediaDevices.getUserMedia({ audio: true });
            addLog("Mic Permission: Granted ‚úÖ");
        } catch (err) {
            addLog("Mic Permission: Denied ‚ùå");
        }
    });

    // Start Call
    startBtn.addEventListener('click', () => {
        if (!vapi) {
            addLog("Error: Vapi not initialized.");
            return;
        }
        addLog("Connecting to Assistant...");
        vapi.start(ASSISTANT_ID);
    });

    // Stop Call
    stopBtn.addEventListener('click', () => {
        vapi.stop();
    });

    // Run init after a slight delay to ensure script tag is parsed
    window.onload = initVapi;
</script>

</body>
</html>
